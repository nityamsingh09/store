{% extends "base.html" %}
{% load static %}

{% block title %} home{% endblock title %}

{% block content %}
<div class="container mt-4">
  <div class="row">
    {% for image in photos %}
    <div class="col-md-3 col-sm-6 mb-4">
      <div class="card shadow-lg border-0 h-100" 
           style="border-radius: 20px; background-color: #fff6d9;">
        
        <!-- Meme Video -->
        {% if image.video %}
       <video class="card-img-top fixed-media" controls preload ="metadata">
          <source src="{{ image.video.url }}" type="video/mp4">
          Your browser does not support the video tag.
        </video>
        {% endif %}

        <!-- Meme Image -->
        {% if image.photo %}
        <img src="{{ image.photo.url }}" class="card-img-top fixed-media" alt="Funny Meme">
        {% endif %}

        <!-- Card Body -->
        <div class="card-body text-center d-flex flex-column justify-content-between">
          <!-- Meme Name -->
          <h5 class="card-title" style="font-family: 'Comic Sans MS'; color: #ff4081;">
            üòÇ {{ image.title }}
          </h5>

          <!-- Like + Download Buttons in One Row -->
     <div class="d-flex justify-content-center gap-2 mt-2">

  <!-- Like Button -->
  <form method="post" action="{% url 'like_meme' image.id %}">
    {% csrf_token %}
    <button type="submit" 
            class="btn btn-outline-danger btn-sm fw-bold px-3 py-1" 
            style="border-radius: 30px; font-size: 0.85rem;">
      ‚ù§Ô∏è {{ image.likes }}
    </button>
  </form>

  <!-- Download Button -->
  {% if image.photo %}
    <a href="{{ image.photo.url }}" download 
       class="btn btn-warning btn-sm fw-bold px-5 py-2" 
       style="border-radius: 30px; font-size: 0.85rem;">Download
      ‚¨áÔ∏è
    </a>
  {% elif image.video %}
    <a href="{{ image.video.url }}" download 
       class="btn btn-warning btn-sm fw-bold px-5 py-2" 
       style="border-radius: 30px; font-size: 0.85rem;">Download
      ‚¨áÔ∏è
    </a>
  {% endif %}
</div>

        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>

<style>
  .fixed-media {
    height: 250px;
    object-fit: cover;
    border-top-left-radius: 20px;
    border-top-right-radius: 20px;
  }
</style>
{% endblock %}
